# ç°ä»£javascriptæ•™ç¨‹

## ç¬¬2éƒ¨åˆ†ï¼šæµè§ˆå™¨ï¼šæ–‡æ¡£ã€äº‹ä»¶å’Œæ¥å£

### ç¬¬ä¸‰ç« ã€äº‹ä»¶ç»†èŠ‚

#### 3.1é¼ æ ‡äº‹ä»¶åŸºç¡€

é¼ æ ‡äº‹ä»¶ä¸ä»…æ¥è‡ªäº â€œmouse manipulatorsâ€ï¼Œè€Œä¸”è¿˜åœ¨è§¦æ‘¸è®¾å¤‡ä¸Šè¢«æ¨¡æ‹Ÿï¼Œä»¥ä¾¿å¯ä»¥è®©å®ƒä»¬ç›¸äº’å…¼å®¹ã€‚

åœ¨æœ¬ç« ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»é¼ æ ‡äº‹ä»¶åŠå…¶å±æ€§ã€‚

##### [é¼ æ ‡äº‹ä»¶ç±»å‹](https://zh.javascript.info/mouse-events-basics#shu-biao-shi-jian-lei-xing)

æˆ‘ä»¬å¯ä»¥å°†é¼ æ ‡äº‹ä»¶åˆ†æˆä¸¤ç±»ï¼šâ€œç®€å•â€å’Œâ€œå¤æ‚â€

###### [ç®€å•äº‹ä»¶](https://zh.javascript.info/mouse-events-basics#jian-dan-shi-jian)

æœ€å¸¸ç”¨çš„ç®€å•äº‹ä»¶æ˜¯ï¼š

- `mousedown/mouseup`

  åœ¨å…ƒç´ ä¸Šå•å‡»/é‡Šæ”¾é¼ æ ‡æŒ‰é’®ã€‚

- `mouseover/mouseout`

  é¼ æ ‡æŒ‡é’ˆä»ä¸€ä¸ªå…ƒç´ ä¸Šç§»å…¥/å‡ºã€‚

- `mousemove`

  é¼ æ ‡æ¯æ¬¡ç§»åŠ¨åˆ°å…ƒç´ ä¸Šæ—¶éƒ½ä¼šè§¦å‘äº‹ä»¶ã€‚

â€¦è¿˜æœ‰å…¶ä»–å‡ ç§äº‹ä»¶ç±»å‹ï¼Œæˆ‘ä»¬ç¨åä¼šè®¨è®ºå®ƒä»¬ã€‚

###### [å¤æ‚äº‹ä»¶](https://zh.javascript.info/mouse-events-basics#fu-za-shi-jian)

- `click`

  å¦‚æœä½¿ç”¨é¼ æ ‡å·¦é”®ï¼Œåˆ™åœ¨ `mousedown` åŠ `mouseup` ç›¸ç»§è§¦å‘åè§¦å‘è¯¥äº‹ä»¶ã€‚

- `contextmenu`

  å¦‚æœä½¿ç”¨é¼ æ ‡å³é”®ï¼Œåˆ™åœ¨ `mousedown` åè§¦å‘ã€‚

- `dblclick`

  åœ¨å¯¹å…ƒç´ è¿›è¡ŒåŒå‡»åè§¦å‘ã€‚

å¤æ‚äº‹ä»¶æ˜¯ç”±ç®€å•äº‹ä»¶ç»„æˆçš„ï¼Œå› æ­¤ç†è®ºä¸Šæˆ‘ä»¬å¯ä»¥æ²¡æœ‰å®ƒä»¬è€Œè¿è½¬ã€‚ä½†å®ƒä»¬çš„å­˜åœ¨å´ç»™æˆ‘ä»¬æä¾›äº†æå¤§çš„ä¾¿åˆ©ã€‚

###### [äº‹ä»¶é¡ºåº](https://zh.javascript.info/mouse-events-basics#shi-jian-shun-xu)

ä¸€ä¸ªåŠ¨ä½œå¯èƒ½ä¼šè§¦å‘å¤šä¸ªäº‹ä»¶ã€‚

æ¯”å¦‚ï¼Œåœ¨æŒ‰ä¸‹é¼ æ ‡æŒ‰é’®æ—¶ï¼Œå•å‡»ä¼šé¦–å…ˆè§¦å‘ `mousedown`ï¼Œç„¶åé‡Šæ”¾é¼ æ ‡æŒ‰é’®æ—¶ï¼Œä¼šè§¦å‘ `mouseup` å’Œ `click`ã€‚

åœ¨å•ä¸ªåŠ¨ä½œè§¦å‘å¤šä¸ªäº‹ä»¶æ—¶ï¼Œå®ƒä»¬çš„é¡ºåºæ˜¯å›ºå®šçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ä¼šéµå¾ª `mousedown` â†’ `mouseup` â†’ `click` çš„é¡ºåºã€‚äº‹ä»¶æŒ‰ç…§ç›¸åŒçš„é¡ºåºè¢«å¤„ç†ï¼š`onmouseup` åœ¨ `onclick` è¿è¡Œä¹‹å‰å®Œæˆã€‚

å•å‡»ä»¥ä¸‹æŒ‰é’®ï¼Œä½ ä¼šçœ‹åˆ°äº‹ä»¶ã€‚ä¹Ÿå¯ä»¥å°è¯•åŒå‡»ã€‚

åœ¨æµ‹è¯•å°ä¸‹é¢è®°å½•æ‰€æœ‰é¼ æ ‡äº‹ä»¶ï¼Œå¦‚æœå®ƒä»¬ä¹‹é—´æœ‰è¶…è¿‡ 1 ç§’çš„å»¶è¿Ÿï¼Œé‚£ä¹ˆå®ƒä»¬ä¼šè¢«è§„åˆ™åˆ†å¼€ã€‚

æˆ‘ä»¬è¿˜å¯ä»¥çœ‹å‡º `which` å±æ€§å…è®¸æ£€æµ‹é¼ æ ‡æŒ‰é’®ã€‚

##### [è·å–æŒ‰é’®ï¼šwhich](https://zh.javascript.info/mouse-events-basics#huo-qu-an-niu-which)

ä¸å•å‡»ç›¸å…³çš„äº‹ä»¶å§‹ç»ˆå…·æœ‰ `which` å±æ€§ï¼Œè¯¥å±æ€§å…è®¸è·å–å‡†ç¡®çš„é¼ æ ‡æŒ‰é’®ã€‚

å®ƒä¸ç”¨äº `click`å’Œ `contextmenu` äº‹ä»¶ï¼Œå› ä¸ºå‰è€…åªå‘ç”Ÿåœ¨å·¦é”®ï¼Œè€Œåè€…åªå‘ç”Ÿåœ¨å³å‡»ã€‚

ä½†å¦‚æœæˆ‘ä»¬è·Ÿè¸ª `mousedown` å’Œ `mouseup`ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å®ƒï¼Œå› ä¸ºè¿™äº›äº‹ä»¶åœ¨ä»»æ„é¼ æ ‡æŒ‰é’®æŒ‰ä¸‹æ—¶éƒ½ä¼šè§¦å‘ï¼Œæ‰€ä»¥ `which`å…è®¸åŒºåˆ† â€œright-mousedownâ€ å’Œ â€œleft-mousedownâ€ã€‚

æœ‰ä¸‰ä¸ªå¯èƒ½çš„å€¼ï¼š

- `event.which == 1` â€”â€” å·¦æŒ‰é’®
- `event.which == 2` â€”â€” ä¸­é—´æŒ‰é’®
- `event.which == 3` â€”â€” å³æŒ‰é’®

ä¸­é—´æŒ‰é’®ç°åœ¨æœ‰äº›ç‰¹æ®Šï¼Œæ‰€æœ‰å¾ˆå°‘è¢«ä½¿ç”¨ã€‚

##### [ç»„åˆé”®: shiftã€altã€ctrl å’Œ meta](https://zh.javascript.info/mouse-events-basics#zu-he-jian-shiftaltctrl-he-meta)

æ‰€æœ‰çš„é¼ æ ‡äº‹ä»¶éƒ½åŒ…å«æœ‰å…³æŒ‰ä¸‹çš„ç»„åˆé”®ä¿¡æ¯ã€‚

å±æ€§ï¼š

- `shiftKey`
- `altKey`
- `ctrlKey`
- `metaKey` (Cmd for Mac)

æ¯”å¦‚ï¼Œä¸‹è¿°æŒ‰é’®ä»…ä»…åœ¨ Alt+Shift+click ä¸Šæœ‰æ•ˆï¼š

```html
<button id="button">Alt+Shift+Click on me!</button>

<script>
  button.onclick = function(event) {
    if (event.altKey && event.shiftKey) {
      alert('Hooray!');
    }
  };
</script>
```

------

**æ³¨æ„ï¼šåœ¨ Mac ä¸Šæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ `Cmd` è€Œä¸æ˜¯ `Ctrl`**

åœ¨ Windows å’Œ Linux ä¸Šä¿®æ”¹é”®æ˜¯ Altã€Shift å’Œ Ctrlã€‚åœ¨ Mac ä¸Šè¿˜æœ‰ï¼šCmdï¼Œå®ƒå¯¹åº”äºå±æ€§ `metaKey`ã€‚

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå½“ Windows/Linux ä½¿ç”¨ Ctrl æ—¶ï¼ŒMac çš„ç”¨æˆ·ä¼šä½¿ç”¨ Cmdã€‚å› æ­¤å½“ Windows ç”¨æˆ·æŒ‰ä¸‹ Ctrl+Enter æˆ– Ctrl+A æ—¶ï¼ŒMac ç”¨æˆ·ä¼šæŒ‰ä¸‹ Cmd+Enter æˆ– Cmd+A ç­‰ï¼Œå¤§å¤šæ•° app ä½¿ç”¨ Cmd è€Œä¸æ˜¯ Ctrlã€‚

å› æ­¤å¦‚æœæˆ‘ä»¬æƒ³æ”¯æŒ Ctrl+clickï¼Œé‚£ä¹ˆå¯¹äº Mac ç”¨æˆ·æ¥è¯´ï¼Œä½¿ç”¨ Cmd+click ä¹Ÿæ˜¯æœ‰æ„ä¹‰çš„ã€‚è¿™å¯¹äº Mac ç”¨æˆ·æ¥è¯´éå¸¸èˆ’æœã€‚

å³ä½¿æˆ‘ä»¬æƒ³è¿«ä½¿ Mac ç”¨æˆ·ä½¿ç”¨ Ctrl+click â€”â€” ä¹Ÿéå¸¸å›°éš¾ã€‚é—®é¢˜åœ¨äºï¼šMac ä¸Šå·¦å‡» Ctrl è¢«è§£é‡Šä¸º**å³å‡»**ï¼Œå®ƒä¼šç”Ÿæˆ `contextmenu` äº‹ä»¶ï¼Œè€Œä¸æ˜¯åƒ Windows/Linxu çš„ `click` äº‹ä»¶ã€‚

å› æ­¤å¦‚æœæˆ‘ä»¬æƒ³è®©æ‰€æœ‰æ“ä½œç³»ç»Ÿçš„ç”¨æˆ·æ„Ÿè§‰èˆ’é€‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å’Œ `ctrlKey` ä¸€èµ·ä½¿ç”¨ `metaKey`ã€‚

å¯¹äº JS ä»£ç ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬åº”è¯¥æ£€æŸ¥ `if (event.ctrlKey || event.metaKey)`ã€‚

##### [åæ ‡ï¼šclientX/Yï¼ŒpageX/Y](https://zh.javascript.info/mouse-events-basics#zuo-biao-clientxypagexy)

æ‰€æœ‰çš„é¼ æ ‡äº‹ä»¶éƒ½æœ‰ä¸¤ç§å½¢å¼çš„åæ ‡ï¼š

1. å¯¹äºçª—å£è€Œè¨€ï¼š`clientX` å’Œ `clientY`ã€‚
2. å¯¹äºæ–‡æ¡£è€Œè¨€ï¼š`pageX` å’Œ `pageY`ã€‚

æ¯”å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ª 500 x 500 çš„çª—å£ï¼Œé¼ æ ‡åœ¨å·¦ä¸Šæ–¹ï¼Œé‚£ä¹ˆ `clientX` å’Œ `clientY` éƒ½æ˜¯ `0`ã€‚å¦‚æœé¼ æ ‡åœ¨ä¸­é—´ï¼Œé‚£ä¹ˆ `clientX` å’Œ `clientY` å°±æ˜¯ `250`ã€‚å’Œå®ƒåœ¨æ–‡æ¡£ä¸­çš„ä½ç½®æ— å…³ã€‚å®ƒä»¬ç±»ä¼¼äº `position:fixed`ã€‚

å°†é¼ æ ‡ç§»åŠ¨åˆ°è¾“å…¥å­—æ®µä¸Šï¼Œå¯ä»¥çœ‹åˆ° `clientX/clientY`ï¼ˆå®ƒåœ¨ `iframe` ä¸­ï¼Œå› æ­¤åæ ‡æ˜¯ç›¸å¯¹äº `iframe` è€Œè¨€çš„ï¼‰ï¼š

```html
<input onmousemove="this.value=event.clientX+':'+event.clientY" value="Mouse over me">
```

æ–‡æ¡£ç›¸å¯¹åæ ‡æ˜¯ä»æ–‡æ¡£çš„å·¦ä¸Šè§’è€Œä¸æ˜¯çª—å£ä¸­è®¡ç®—å‡ºæ¥çš„ã€‚ åæ ‡ `pageX`ï¼Œ`pageY` ä¸æ–‡æ¡£çº§åˆ«ä¸Šçš„ `position:absolute` éå¸¸ç›¸ä¼¼ã€‚

ä½ å¯ä»¥åœ¨æœ¬ç« ä¸­é˜…è¯»åˆ°æ›´å¤šå…³äºåæ ‡çš„å†…å®¹ [åæ ‡](https://zh.javascript.info/coordinates)ã€‚

##### [Mousedown æ²¡æœ‰é€‰æ‹©](https://zh.javascript.info/mouse-events-basics#mousedown-mei-you-xuan-ze)

é¼ æ ‡ç‚¹å‡»æœ‰ä¸€ä¸ªè®©äººä¸å®‰çš„å‰¯ä½œç”¨ã€‚åŒå‡»å¯ä»¥é€‰æ‹©æ–‡æœ¬ã€‚

å¦‚æœæˆ‘ä»¬æƒ³è‡ªå·±å¤„ç†ç‚¹å‡»äº‹ä»¶ï¼Œé‚£ä¹ˆâ€œé¢å¤–â€çš„é€‰æ‹©å°±æ˜¾å¾—å¤šä½™äº†ã€‚

æ¯”å¦‚ï¼Œå¯¹ä¸‹é¢çš„æ–‡æœ¬åŒå‡»ï¼Œé™¤äº†æˆ‘ä»¬çš„è§¦å‘äº‹ä»¶ä¹‹å¤–ï¼Œè¿˜ä¼šé€‰æ‹©æ–‡æœ¬ï¼š

```html
<b ondblclick="alert('dblclick')">Double-click me</b>
```

è¿˜æœ‰ CSS æ–¹æ³•å¯ä»¥ç»ˆæ­¢é€‰æ‹©ï¼š[CSS UI è‰æ¡ˆ](https://www.w3.org/TR/css-ui-4/) ä¸­çš„ `user-select` å±æ€§ã€‚

å¤§å¤šæ•°æµè§ˆå™¨éƒ½æ”¯æŒå®ƒçš„å‰ç¼€ï¼š

```html
<style>
  b {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
</style>

Before...
<b ondblclick="alert('Test')">
  Unselectable
</b>
...After
```

å¦‚æœç°åœ¨ä½ åŒå‡»â€œä¸å¯é€‰â€ï¼Œå®ƒå°±ä¸ä¼šè¢«é€‰ä¸­äº†ã€‚çœ‹èµ·æ¥å¥½åƒèµ·ä½œç”¨äº†ã€‚

â€¦ä½†æœ‰ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼æ–‡æœ¬å˜å¾—æ— æ³•è¢«é€‰ä¸­ã€‚å³ä½¿ç”¨æˆ·ä»â€œä¹‹å‰â€å¼€å§‹é€‰æ‹©ï¼Œâ€œä¹‹åâ€ç»“æŸï¼Œé€‰æ‹©ä¹Ÿä¼šè·³è¿‡â€œä¸å¯é€‰æ‹©â€éƒ¨åˆ†ã€‚æˆ‘ä»¬çœŸçš„æƒ³è®©æ–‡æœ¬ä¸å¯é€‰ä¹ˆï¼Ÿ

å¤§éƒ¨åˆ†æ—¶é—´ï¼Œæˆ‘ä»¬ä¸ä¼šé‚£ä¹ˆåšã€‚ç”¨æˆ·å¯èƒ½æœ‰åˆç†çš„ç†ç”±æ¥é€‰æ‹©æ–‡æœ¬ï¼Œä»¥ä¾¿è¿›è¡Œå¤åˆ¶æˆ–å…¶ä»–éœ€è¦ã€‚å¦‚æœæˆ‘ä»¬ä¸è®©ä»–é‚£ä¹ˆåšé‚£ä¹ˆå¯èƒ½ä¸å¤ªæ–¹ä¾¿ã€‚æ‰€ä»¥è¿™ä¸ªè§£å†³æ–¹æ¡ˆæ²¡é‚£ä¹ˆå¥½ã€‚

æˆ‘ä»¬åªæ˜¯æƒ³é˜»æ­¢åŒå‡»è¿›è¡Œé€‰æ‹©ï¼Œä»…æ­¤è€Œå·²ã€‚

æ–‡æœ¬é€‰æ‹©æ˜¯ `mousedown` äº‹ä»¶çš„é»˜è®¤æµè§ˆå™¨æ“ä½œã€‚å› æ­¤å…¶ä»–æ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯å¤„ç† `mousedown` å¹¶é˜»æ­¢å®ƒå‘ç”Ÿï¼Œå°±åƒè¿™æ ·ï¼š

```html
Before...
<b ondblclick="alert('Click!')" onmousedown="return false">
  Double-click me
</b>
...After
```

ç°åœ¨ï¼Œåœ¨åŒå‡»æ—¶ä¸é€‰æ‹©ç²—ä½“å…ƒç´ ã€‚

å†…éƒ¨æ–‡å­—ä»ç„¶å¯ä»¥è¢«é€‰ä¸­ã€‚ä½†é€‰æ‹©å´ä¸åº”è¯¥ä»æ–‡æœ¬è‡ªèº«å¼€å§‹ï¼Œè€Œæ˜¯åº”è¯¥åœ¨æ–‡å­—ä¹‹å‰æˆ–ä¹‹åå¼€å§‹ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯æ­£å¸¸çš„ã€‚

------

**å–æ¶ˆé€‰æ‹©**

æˆ‘ä»¬å¯ä»¥åœ¨äº‹ä»¶å¤„ç†å™¨ä¸­ç”¨ â€œpost-factumâ€ å–æ¶ˆå®ƒï¼Œè€Œä¸æ˜¯**é˜»æ­¢**é€‰æ‹©å®ƒã€‚

è¿™æ˜¯æ–¹æ³•ï¼š

```html
Before...
<b ondblclick="getSelection().removeAllRanges()">
  Double-click me
</b>
...After
```

å¦‚æœä½ åŒå‡»ç²—ä½“å…ƒç´ ï¼Œåˆ™ä¼šå‡ºç°æ‰€é€‰å†…å®¹ï¼Œç„¶åç«‹å³åˆ é™¤ï¼Œä¸è¿‡çœ‹èµ·æ¥ä¸å¤ªå¥½ã€‚

------

**é˜²æ­¢å¤åˆ¶**

å¦‚æœæˆ‘ä»¬æƒ³è¦ç¦ç”¨é€‰æ‹©ä»¥ä¿æŠ¤å†…å®¹ä¸è¢«å¤åˆ¶ç²˜è´´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªäº‹ä»¶ï¼š`oncopy`ã€‚

```html
<div oncopy="alert('Copying forbidden!');return false">
  Dear user,
  The copying is forbidden for you.
  If you know JS or HTML, then you can get everything from the page source though.
</div>
```

å¦‚æœä½ è¯•å›¾åœ¨ `<div>` ä¸­å¤åˆ¶ä¸€æ®µæ–‡æœ¬ï¼Œè¿™æ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºé»˜è®¤æ“ä½œ `oncopy` æ˜¯è¢«é˜»æ­¢çš„ã€‚

å½“ç„¶ï¼Œè¿™ä¸èƒ½é˜»æ­¢ç”¨æˆ·æ‰“å¼€ HTML æºä»£ç ï¼Œä½†å¹¶ä¸æ˜¯æ¯ä¸ªäººéƒ½çŸ¥é“å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚

##### [æ€»ç»“](https://zh.javascript.info/mouse-events-basics#zong-jie)

é¼ æ ‡äº‹ä»¶æœ‰å¦‚ä¸‹å±æ€§ï¼š

- æŒ‰é’®ï¼š`which`ã€‚
- ä¿®é¥°ç¬¦é”®ï¼ˆ`true` å¦‚æœè¢«æŒ‰å‹ï¼‰ï¼š`altKey`ã€`ctrlKey`ã€`shiftKey` å’Œ `metaKey`ï¼ˆMacï¼‰ã€‚
  - å¦‚æœæƒ³è¦å¤„ç† Ctrlï¼Œé‚£ä¹ˆä¸è¦å¿˜è®° Mac ç”¨æˆ·ï¼Œä»–ä»¬ä½¿ç”¨çš„æ˜¯ Cmdï¼Œæ‰€ä»¥æœ€å¥½æ£€æŸ¥ `if (e.metaKey || e.ctrlKey)`ã€‚
- çª—å£ç›¸å¯¹åæ ‡ï¼š`clientX/clientY`ã€‚
- æ–‡æ¡£ç›¸å¯¹åæ ‡ï¼š`pageX/pageY`ã€‚

å¤„ç†æ–‡æœ¬é€‰æ‹©è™½ç„¶ä¹Ÿæ˜¯ä¸å¿…è¦çš„ç‚¹å‡»å‰¯ä½œç”¨ï¼Œä½†æ˜¯å´å¾ˆé‡è¦ã€‚

è¿˜æœ‰å‡ ç§å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹çš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼š

1. CSS å±æ€§ `user-select:none`ï¼ˆå¸¦æœ‰æµè§ˆå™¨å‰ç¼€ï¼‰å®Œå…¨ç¦ç”¨æ–‡æœ¬é€‰æ‹©ã€‚
2. ä½¿ç”¨ `getSelection().removeAllRanges()` å–æ¶ˆé€‰æ‹©åçš„å†…å®¹ã€‚
3. å¤„ç† `mousedown` å¹¶é˜»æ­¢é»˜è®¤æ“ä½œï¼ˆé€šå¸¸æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼‰ã€‚

#### 3.2ç§»åŠ¨ï¼šmouseover/outï¼Œmouseenter/leave

æˆ‘ä»¬å°†æ·±å…¥ç ”ç©¶é¼ æ ‡åœ¨å…ƒç´ ä¹‹é—´ç§»åŠ¨æ—¶æ‰€å‘ç”Ÿäº‹ä»¶çš„æ›´å¤šç»†èŠ‚ã€‚

##### [Mouseover/mouseoutï¼ŒrelatedTarget](https://zh.javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave#mouseovermouseoutrelatedtarget)

å½“é¼ æ ‡æŒ‡é’ˆå‡ºç°åœ¨ä¸€ä¸ªå…ƒç´ ä¸Šæ—¶ï¼Œ`mouseover` äº‹ä»¶å°±ä¼šå‘ç”Ÿï¼Œè€Œ `mouseout` äº‹ä»¶åˆ™å‘ç”Ÿåœ¨é¼ æ ‡æŒ‡é’ˆç¦»å¼€æ—¶ã€‚

![image-20191118141126393](ç¬¬ä¸‰ç« .assets/image-20191118141126393.png)

è¿™äº›äº‹ä»¶å¾ˆç‰¹åˆ«ï¼Œå› ä¸ºå®ƒä»¬æœ‰ `relatedTarget`ã€‚

å¯¹äº `mouseover`ï¼š

- `event.target` â€”â€” æ˜¯é¼ æ ‡ç»è¿‡çš„é‚£ä¸ªå…ƒç´ ã€‚
- `event.relatedTarget` â€”â€” æ˜¯é¼ æ ‡ä¸Šä¸€æ¬¡ç»è¿‡çš„å…ƒç´ ã€‚

`mouseout` åˆ™ä¸ä¹‹ç›¸åï¼š

- `event.target` â€”â€” æ˜¯é¼ æ ‡ç¦»å¼€çš„å…ƒç´ ã€‚
- `event.relatedTarget` â€”â€” æ˜¯å½“å‰æŒ‡é’ˆä½ç½®ä¸‹çš„ï¼ˆé¼ æ ‡è¿›å…¥çš„ï¼‰å…ƒç´ ã€‚

------

**`relatedTarget` å¯ä»¥ä¸º `null`**

`relatedTarget` å±æ€§å¯ä»¥ä¸º `null`ã€‚

è¿™å¾ˆæ­£å¸¸ï¼Œè€Œä¸”æ„å‘³ç€é¼ æ ‡ä¸æ˜¯æ¥æºäºå¦ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ˜¯çª—å£ä»¥å¤–ã€‚æˆ–è€…æ˜¯ç¦»å¼€äº†çª—å£ã€‚

å½“æˆ‘ä»¬åœ¨ä»£ç ä¸­ä½¿ç”¨ `event.relatedTarget` æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è®°ä½è¿™ç§å¯èƒ½æ€§ã€‚å¦‚æœæˆ‘ä»¬è®¿é—® `event.relatedTarget.tagName`ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°é”™è¯¯ã€‚

##### [äº‹ä»¶é¢‘ç‡](https://zh.javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave#shi-jian-pin-shuai)

å½“æœ‰é¼ æ ‡ç§»åŠ¨æ—¶ï¼Œ`mousemove` äº‹ä»¶å°±ä¼šè¢«è§¦å‘ã€‚ä½†æ˜¯è¿™ä¸æ„å‘³ç€æ¯ä¸ªåƒç´ éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªäº‹ä»¶ã€‚

æµè§ˆå™¨ä¼šä¸€ç›´æ£€æŸ¥é¼ æ ‡çš„ä½ç½®ã€‚å¦‚æœå®ƒæ³¨æ„åˆ°é¼ æ ‡å˜åŒ–äº†ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘ç›¸åº”çš„äº‹ä»¶ã€‚

è¿™æ„å‘³ç€å¦‚æœè®¿é—®è€…éå¸¸å¿«åœ°ç§»åŠ¨é¼ æ ‡ï¼Œé‚£ä¹ˆ DOM å…ƒç´ å°±ä¼šè¢«è·³è¿‡ï¼š

![image-20191118141825331](ç¬¬ä¸‰ç« .assets/image-20191118141825331.png)

å¦‚æœé¼ æ ‡ä»ä¸Šé¢çš„ `#FROM` åˆ° `#TO` å…ƒç´ ç§»åŠ¨åœ°éå¸¸å¿«ï¼Œé‚£ä¹ˆä¸­é—´çš„ `<div>`ï¼ˆæˆ–å…¶ä¸­çš„ä¸€äº›ï¼‰å¯èƒ½ä¼šè¢«è·³è¿‡ã€‚`mouseout` äº‹ä»¶å¯èƒ½ä¼šåœ¨ `#FROM` ä¸Šè¢«è§¦å‘ï¼Œç„¶åç«‹å³åœ¨ `#TO` ä¸Šè§¦å‘ `mouseover`ã€‚

è¿™åœ¨å®è·µä¸­æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºå¯èƒ½ä¼šæœ‰è®¸å¤šä¸­é—´å…ƒç´ ã€‚æˆ‘ä»¬å¹¶ä¸æ˜¯çœŸçš„æƒ³è¦å¤„ç†æ¯ä¸€ä¸ªè¿›å…¥ç¦»å¼€çš„è¿‡ç¨‹ã€‚

å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬åº”è¯¥è®°ä½ï¼Œæˆ‘ä»¬ä¸èƒ½å‡è®¾é¼ æ ‡ä¼šç¼“æ…¢åœ°ä»ä¸€ä¸ªäº‹ä»¶ç§»åŠ¨åˆ°å¦ä¸€ä¸ªäº‹ä»¶ã€‚æ˜¯çš„ï¼Œå®ƒå¯ä»¥â€œè·³â€ã€‚

ç‰¹åˆ«æ˜¯ï¼Œå…‰æ ‡å¯èƒ½ä»çª—å£å¤–è·³è¿›é¡µé¢çš„ä¸­é—´ã€‚æ­¤æ—¶ `relatedTarget=null`ï¼Œè¿™æ˜¯å› ä¸ºé¼ æ ‡æ¥è‡ªâ€œçª—å£å¤–ï¼ˆnowhereï¼‰â€ï¼š

![image-20191118141833317](ç¬¬ä¸‰ç« .assets/image-20191118141833317.png)

##### [è¿›å…¥å­å…ƒç´ æ—¶çš„â€œé¢å¤–â€ mouseout](https://zh.javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave#jin-ru-zi-yuan-su-shi-de-ewai-mouseout)

æƒ³è±¡ä¸€ä¸‹ â€”â€” é¼ æ ‡æŒ‡é’ˆè¿›å…¥ä¸€ä¸ªå…ƒç´ ã€‚`mouseover` è¢«è§¦å‘ã€‚ç„¶åå…‰æ ‡è¿›å…¥ä¸€ä¸ªå­å…ƒç´ ã€‚æœ‰è¶£çš„æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ `mouseout`ä¼šè¢«è§¦å‘ã€‚å…‰æ ‡ä»ç„¶åœ¨å…ƒç´ ä¸­ï¼Œä½†æˆ‘ä»¬ä»å®ƒé‚£å„¿æ¥æ”¶åˆ°äº† `mouseout` äº‹ä»¶ï¼

![image-20191118141915293](ç¬¬ä¸‰ç« .assets/image-20191118141915293.png)

è¿™å¬èµ·æ¥å¾ˆå¥‡æ€ªï¼Œä½†å¾ˆå®¹æ˜“è§£é‡Šã€‚

**æ ¹æ®æµè§ˆå™¨é€»è¾‘ï¼Œé¼ æ ‡å…‰æ ‡åœ¨ä»»æ„æ—¶é—´åªä¼šä½äº\*å•ä¸ª\*å…ƒç´ ä¸Š â€”â€” åµŒå¥—æœ€å¤šçš„é‚£ä¸ªï¼ˆè€Œä¸”æ˜¯ z-index æœ€å¤§çš„é‚£ä¸ªï¼‰ã€‚**

å› æ­¤å¦‚æœå®ƒè½¬åˆ°å¦ä¸€ä¸ªå…ƒç´ ï¼ˆç”šè‡³æ˜¯ä¸€ä¸ªå­ä»£ï¼‰ï¼Œé‚£ä¹ˆå®ƒå°†ç¦»å¼€å…ˆå‰çš„é‚£ä¸ªã€‚å°±è¿™ä¹ˆç®€å•ã€‚

##### [Mouseenter å’Œ mouseleave äº‹ä»¶](https://zh.javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave#mouseenter-he-mouseleave-shi-jian)

`mouseenter/mouseleave` äº‹ä»¶ç±»ä¼¼äº `mouseover/mouseout`ã€‚å½“é¼ æ ‡æŒ‡é’ˆç§»å…¥/ç§»å‡ºå…ƒç´ æ—¶ï¼Œå®ƒä»¬ä¹Ÿä¼šè¢«è§¦å‘ã€‚

ä½†æœ‰ä¸¤ä¸ªä¸åŒä¹‹å¤„ï¼š

1. å…ƒç´ å†…éƒ¨çš„è½¬æ¢ä¸ä¼šæœ‰å½±å“ã€‚
2. `mouseenter/mouseleave` äº‹ä»¶ä¸ä¼šå†’æ³¡ã€‚

è¿™äº›äº‹ä»¶åœ¨ç›´è§‰ä¸Šéå¸¸æ¸…æ™°ã€‚

å½“æŒ‡é’ˆè¿›å…¥ä¸€ä¸ªå…ƒç´ æ—¶ â€”â€” `mouseenter` è¢«è§¦å‘ï¼Œè€Œå®ƒåœ¨å…ƒç´ å†…éƒ¨çš„å»å‘å¹¶ä¸é‡è¦ã€‚åªæœ‰å½“é¼ æ ‡å…‰æ ‡ç¦»å¼€æ—¶ï¼Œ`mouseleave`äº‹ä»¶æ‰ä¼šè¢«è§¦å‘ã€‚

##### [äº‹ä»¶å§”æ‰˜](https://zh.javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave#shi-jian-wei-tuo)

`mouseenter/leave` äº‹ä»¶éå¸¸ç®€å•ï¼Œä¹Ÿéå¸¸å®¹æ˜“ä½¿ç”¨ã€‚ä½†å®ƒä»¬ä¸ä¼šå†’æ³¡ã€‚å› æ­¤æˆ‘ä»¬ä¸èƒ½ç”¨å®ƒä»¬æ¥è¿›è¡Œäº‹ä»¶å§”æ‰˜ã€‚

æƒ³è±¡æˆ‘ä»¬æƒ³è¦ä¸ºè¡¨å•å…ƒæ¥å¤„ç†é¼ æ ‡çš„ç§»å…¥/ç§»é™¤ã€‚æœ‰å‡ ç™¾ä¸ªè¡¨å•å…ƒã€‚

é€šå¸¸çš„è§£å†³æ–¹æ¡ˆæ˜¯ â€”â€” åœ¨ `<table>` ä¸­è®¾ç½®å¤„ç†å™¨ï¼Œå¹¶åœ¨é‚£é‡Œå¤„ç†äº‹ä»¶ã€‚ä½† `mouseenter/leave` ä¸ä¼šå†’æ³¡ã€‚å› æ­¤å¦‚æœç±»ä¼¼äº‹ä»¶å‘ç”Ÿåœ¨ `<td>` ä¸Šï¼Œé‚£ä¹ˆåªæœ‰ `<td>` ä¸Šçš„å¤„ç†å™¨æ‰èƒ½æ•è·åˆ°å®ƒã€‚

åªæœ‰åœ¨ç§»å…¥/ç§»å‡ºæ•´ä¸ªè¡¨å•æ—¶æ‰ä¼šè§¦å‘å¤„ç†å™¨å¤„ç† `<table>` ä¸Šçš„ `mouseenter/leave`ã€‚åœ¨å®ƒå†…éƒ¨è½¬æ¢çš„ä»»ä½•ä¿¡æ¯éƒ½æ— æ³•è·å–ã€‚

æ²¡é—®é¢˜ â€”â€” æˆ‘ä»¬ä½¿ç”¨ `mouseover/mouseout`ã€‚

ä¸€ä¸ªç®€å•çš„å¤„ç†å™¨å¯èƒ½åƒè¿™æ ·ï¼š

```javascript
// é«˜äº®é¼ æ ‡ä¸‹çš„å•å…ƒ
table.onmouseover = function(event) {
  let target = event.target;
  target.style.background = 'pink';
};

table.onmouseout = function(event) {
  let target = event.target;
  target.style.background = '';
};
```

è¿›å…¥åˆ°ä»»ä½•å…ƒç´ æˆ–è€…è¡¨æ ¼å†…çš„å…ƒç´ æ—¶ï¼Œè¿™äº›å¤„ç†å™¨éƒ½å¯ä»¥è¿è¡Œã€‚

ä½†æˆ‘ä»¬åªæƒ³å¤„ç†æ•´ä¸ª `<td>` å…ƒç´ ä¸­çš„è¿›å‡ºè½¬æ¢ã€‚é«˜äº®æ˜¾ç¤ºæ•´ä¸ªå•å…ƒã€‚æˆ‘ä»¬ä¸æƒ³å¤„ç† `<td>` å­çº§ä¹‹é—´å‘ç”Ÿçš„è½¬æ¢ã€‚

å…¶ä¸­ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼š

- è®°ä½åœ¨å˜é‡ä¸­é«˜äº®æ˜¾ç¤ºçš„ `<td>`ã€‚
- `mouseover` â€”â€” å¦‚æœæˆ‘ä»¬ä»ç„¶åœ¨å½“å‰ `<td>` å†…ï¼Œåˆ™å¿½ç•¥è¯¥äº‹ä»¶ã€‚
- `mouseout` â€”â€” å¦‚æœæ²¡æœ‰ç¦»å¼€ `<td>`ï¼Œåˆ™å¿½ç•¥ã€‚

å½“æˆ‘ä»¬åœ¨ ` çš„å­ä»£é—´ç§»åŠ¨æ—¶ï¼Œä¼šè¿‡æ»¤æ‰â€œé¢å¤–â€äº‹ä»¶ã€‚

ä»¥ä¸‹æ˜¯åŒ…å«æ‰€æœ‰ç»†èŠ‚çš„å®Œæ•´ç¤ºä¾‹ï¼š

```javascript
// <td> under the mouse right now (if any)
let currentElem = null;

table.onmouseover = function(event) {
  if (currentElem) {
    // before entering a new element, the mouse always leaves the previous one
    // if we didn't leave <td> yet, then we're still inside it, so can ignore the event
    return;
  }

  let target = event.target.closest('td');
  if (!target || !table.contains(target)) return;

  // yeah we're inside <td> now
  currentElem = target;
  target.style.background = 'pink';
};


table.onmouseout = function(event) {
  // if we're outside of any <td> now, then ignore the event
  if (!currentElem) return;

  // we're leaving the element -- where to? Maybe to a child element?
  let relatedTarget = event.relatedTarget;
  if (relatedTarget) { // possible: relatedTarget = null
    while (relatedTarget) {
      // go up the parent chain and check -- if we're still inside currentElem
      // then that's an internal transition -- ignore it
      if (relatedTarget == currentElem) return;
      relatedTarget = relatedTarget.parentNode;
    }
  }

  // we left the element. really.
  currentElem.style.background = '';
  currentElem = null;
};
```

```css
#text {
  display: block;
  height: 100px;
  width: 456px;
}

#table th {
  text-align: center;
  font-weight: bold;
}

#table td {
  width: 150px;
  white-space: nowrap;
  text-align: center;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 12px;
}

#table .nw {
  background: #999;
}

#table .n {
  background: #03f;
  color: #fff;
}

#table .ne {
  background: #ff6;
}

#table .w {
  background: #ff0;
}

#table .c {
  background: #60c;
  color: #fff;
}

#table .e {
  background: #09f;
  color: #fff;
}

#table .sw {
  background: #963;
  color: #fff;
}

#table .s {
  background: #f60;
  color: #fff;
}

#table .se {
  background: #0c3;
  color: #fff;
}

#table .highlight {
  background: red;
}
```

```html
<!DOCTYPE HTML>
<html>

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>


  <table id="table">
    <tr>
      <th colspan="3"><em>Bagua</em> Chart: Direction, Element, Color, Meaning</th>
    </tr>
    <tr>
      <td class="nw"><strong>Northwest</strong>
        <br>Metal
        <br>Silver
        <br>Elders
      </td>
      <td class="n"><strong>North</strong>
        <br>Water
        <br>Blue
        <br>Change
      </td>
      <td class="ne"><strong>Northeast</strong>
        <br>Earth
        <br>Yellow
        <br>Direction
      </td>
    </tr>
    <tr>
      <td class="w"><strong>West</strong>
        <br>Metal
        <br>Gold
        <br>Youth
      </td>
      <td class="c"><strong>Center</strong>
        <br>All
        <br>Purple
        <br>Harmony
      </td>
      <td class="e"><strong>East</strong>
        <br>Wood
        <br>Blue
        <br>Future
      </td>
    </tr>
    <tr>
      <td class="sw"><strong>Southwest</strong>
        <br>Earth
        <br>Brown
        <br>Tranquility
      </td>
      <td class="s"><strong>South</strong>
        <br>Fire
        <br>Orange
        <br>Fame
      </td>
      <td class="se"><strong>Southeast</strong>
        <br>Wood
        <br>Green
        <br>Romance
      </td>
    </tr>

  </table>

  <script src="script.js"></script>

</body>
</html>

```

å°è¯•åœ¨è¡¨æ ¼å•å…ƒä¹‹é—´æˆ–å†…éƒ¨ç§»åŠ¨å…‰æ ‡ï¼Œå¤ªå¿«æˆ–å¤ªæ…¢éƒ½æœ‰é—®é¢˜ã€‚ä¸ä¹‹å‰ä¸åŒçš„æ˜¯åªæœ‰ ` ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«é«˜äº®æ˜¾ç¤ºã€‚

##### [æ€»ç»“](https://zh.javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave#zong-jie)

æˆ‘ä»¬è®²è¿°äº† `mouseover`ã€`mouseout`ã€`mousemove`ã€`mouseenter` å’Œ `mouseleave` äº‹ä»¶ã€‚

å€¼å¾—æ³¨æ„çš„äº‹æƒ…ï¼š

- é¼ æ ‡çš„å¿«é€Ÿç§»åŠ¨å¯ä»¥ä½¿ `mouseover, mousemove, mouseout` è·³è¿‡ä¸€äº›ä¸­é—´å…ƒç´ ã€‚
- `mouseover/out` äº‹ä»¶å’Œ `mouseenter/leave` äº‹ä»¶æœ‰ä¸€ä¸ªé¢å¤–çš„ç›®æ ‡ï¼š`relatedTarget`ã€‚è¿™æ˜¯ä½œä¸ºèµ·ç‚¹/ç»ˆç‚¹çš„å…ƒç´ ï¼Œæ˜¯å¯¹ `target` çš„è¡¥å……ã€‚
- å³ä½¿ä»çˆ¶å…ƒç´ è½¬åˆ°å­å…ƒç´ æ—¶ï¼Œ`mouseover/out` ä¹Ÿä¼šè¢«è§¦å‘ã€‚å®ƒä»¬å‡è®¾é¼ æ ‡ä¸€æ¬¡åªä¼šç§»å…¥ä¸€ä¸ªå…ƒç´  â€”â€” æœ€æ·±çš„é‚£ä¸ªã€‚
- `mouseenter/leave` äº‹ä»¶ä¸ä¼šå†’æ³¡ï¼Œè€Œä¸”å½“é¼ æ ‡è¿›å…¥å­å…ƒç´ æ—¶ä¹Ÿä¸ä¼šè¢«è§¦å‘ã€‚å®ƒä»¬åªå…³æ³¨é¼ æ ‡åœ¨æ•´ä¸ªå…ƒç´ çš„å†…éƒ¨è¿˜æ˜¯å¤–éƒ¨ã€‚

##### ä»»åŠ¡

###### ["Smart" å·¥å…·æç¤º](https://zh.javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave#smart-gong-ju-ti-shi)

**æˆ‘è‡ªé—­äº†ï¼Œå¥½éš¾ã€‚**

#### 3.3æ‹–æ”¾é¼ æ ‡äº‹ä»¶

æ‹–æ”¾æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç•Œé¢è§£å†³æ–¹æ¡ˆã€‚ä»å¤åˆ¶å’Œç§»åŠ¨ï¼ˆå‚è€ƒæ–‡ä»¶ç®¡ç†ï¼‰åˆ°æ’åºï¼ˆæ”¾å…¥è´­ç‰©è½¦ï¼‰ï¼Œæ‹–æ”¾æ˜¯ä¸€ç§ç®€æ´æ˜äº†çš„æ–¹æ³•ã€‚

åœ¨ç°ä»£ HTML æ ‡å‡†ä¸­ï¼Œæœ‰ä¸€ä¸ª[æ‹–åŠ¨äº‹ä»¶çš„éƒ¨åˆ†](https://html.spec.whatwg.org/multipage/interaction.html#dnd)ã€‚

è¿™å¾ˆæœ‰è¶£ï¼Œå› ä¸ºå®ƒä»¬å…è®¸è½»æ¾åœ°è§£å†³ä¸€äº›ç®€å•çš„ä»»åŠ¡ï¼Œè€Œä¸”å…è®¸å¤„ç†â€œå¤–éƒ¨â€æ–‡ä»¶æ‹–æ”¾åˆ°æµè§ˆå™¨ä¸­çš„äº‹ä»¶ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ OS æ–‡ä»¶ç®¡ç†ä¸­è·å–æ–‡ä»¶ï¼Œå¹¶å°†å…¶æ‹–åŠ¨åˆ°æµè§ˆå™¨çª—å£ã€‚ç„¶å JavaScript è·å–å¯¹å…¶å†…å®¹çš„è®¿é—®æƒé™ã€‚

ä½†æ˜¯æœ¬åœ°çš„æ‹–åŠ¨äº‹ä»¶æ€»æ˜¯æœ‰å±€é™æ€§ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‹–åŠ¨èŒƒå›´é™åˆ¶åœ¨æŸä¸ªåŒºåŸŸå†…ã€‚è€Œä¸”æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå®ƒå˜æˆ â€œhorizontalâ€ æˆ– â€œverticalâ€ã€‚è¿˜æœ‰å…¶ä»–çš„æ‹–æ”¾ä»»åŠ¡æ— æ³•é€šè¿‡ä½¿ç”¨ API å®ç°ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨é¼ æ ‡äº‹ä»¶å®ç°æ‹–æ”¾ã€‚å¹¶ä¸éš¾ã€‚

##### [æ‹–æ”¾ç®—æ³•](https://zh.javascript.info/mouse-drag-and-drop#tuo-fang-suan-fa)

æ‹–æ”¾åŸºç¡€ç®—æ³•å°±åƒè¿™æ ·ï¼š

1. åœ¨å¯æ‹–åŠ¨å…ƒç´ ä¸Šæ•è· `mousedown` äº‹ä»¶ã€‚
2. å‡†å¤‡è¦ç§»åŠ¨çš„å…ƒç´ ï¼ˆå¯èƒ½åˆ›å»ºå®ƒçš„å‰¯æœ¬æˆ–å…¶ä»–ä»»ä½•ä¸œè¥¿ï¼‰ã€‚
3. ç„¶ååœ¨ `mousemove` ä¸Šï¼Œé€šè¿‡æ”¹å˜ `left/top` å’Œ `position:absolute` æ¥ç§»åŠ¨å®ƒã€‚
4. åœ¨ `mouseup`ï¼ˆé‡Šæ”¾æŒ‰é’®ï¼‰ä¸­ â€”â€” æ‰§è¡Œæ‰€æœ‰å®Œæˆæ‹–æ”¾ç›¸å…³çš„åŠ¨ä½œã€‚

è¿™äº›æ˜¯åŸºç¡€ã€‚æˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œæ‹“å±•ï¼Œä¾‹å¦‚ï¼Œå½“é¼ æ ‡åœ¨å¯æ‹–åŠ¨å…ƒç´ ä¸Šæ‚¬åœæ—¶ï¼Œé«˜äº®è¿™ä¸ªå…ƒç´ ã€‚

è¿™æ˜¯æ‹–æ”¾çƒçš„ç®—æ³•ï¼š

```javascript
ball.onmousedown = function(event) { // (1) å¯åŠ¨è¿›ç¨‹

  // (2) å‡†å¤‡ç§»åŠ¨ï¼šç¡®ä¿ absoluteï¼Œä»¥åŠç”¨ z-index ç¡®ä¿åœ¨é¡¶éƒ¨
  ball.style.position = 'absolute';
  ball.style.zIndex = 1000;
  // å°†å®ƒä»å½“å‰çˆ¶äº²ä¸­ç›´æ¥ç§»åˆ° body ä¸­
  // ç¡®ä¿å®ƒçš„ä½ç½®æ˜¯ç›¸å¯¹äº body çš„
  document.body.append(ball);
  // ...å°†ç»å¯¹å®šä½çš„çƒæ”¾åœ¨å…‰æ ‡ä¸‹

  moveAt(event.pageX, event.pageY);

  // å°†çƒä¸­å¿ƒå›ºå®šåœ¨ (pageX, pageY) åæ ‡ä¸Š
  function moveAt(pageX, pageY) {
    ball.style.left = pageX - ball.offsetWidth / 2 + 'px';
    ball.style.top = pageY - ball.offsetHeight / 2 + 'px';
  }

  function onMouseMove(event) {
    moveAt(event.pageX, event.pageY);
  }

  // (3) åœ¨ mousemove äº‹ä»¶ä¸­ç§»åŠ¨çƒ
  document.addEventListener('mousemove', onMouseMove);

  // (4) é‡Šæ”¾çƒï¼Œç§»é™¤ä¸éœ€è¦çš„å¤„ç†å™¨
  ball.onmouseup = function() {
    document.removeEventListener('mousemove', onMouseMove);
    ball.onmouseup = null;
  };

};
```

å¦‚æœæˆ‘ä»¬è¿è¡Œä»£ç ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸€äº›å¥‡æ€ªçš„äº‹æƒ…ã€‚åœ¨æ‹–æ”¾çš„ä¸€å¼€å§‹ï¼Œçƒä¼š â€œforksâ€ï¼šæˆ‘ä»¬å¼€å§‹æ‹–åŠ¨å®ƒçš„ â€œcloneâ€ã€‚

å°è¯•æ‹–æ”¾é¼ æ ‡ï¼Œä½ ä¼šçœ‹åˆ°å¥‡æ€ªçš„è¡Œä¸ºã€‚

è¿™æ˜¯å› ä¸ºæµè§ˆå™¨æœ‰è‡ªå·±æ‹–æ”¾å›¾åƒåŠŸèƒ½å’Œå…¶ä»–ä¸€äº›è‡ªåŠ¨è¿è¡Œå¯èƒ½ä¸æˆ‘ä»¬çš„äº§ç”Ÿå†²çªçš„å…ƒç´ ã€‚

å¦‚æœç¦ç”¨ï¼š

```javascript
ball.ondragstart = function() {
  return false;
};
```

ç°åœ¨ä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥çš„ã€‚

å¦ä¸€ä¸ªé‡è¦çš„æ–¹é¢æ˜¯ â€”â€” æˆ‘ä»¬åœ¨ `document` ä¸Šè·Ÿè¸ª `mousemove`ï¼Œè€Œä¸æ˜¯åœ¨ `ball` ä¸Šã€‚ç¬¬ä¸€çœ¼çœ‹ï¼Œé¼ æ ‡ä¼¼ä¹æ€»æ˜¯åœ¨çƒçš„ä¸Šæ–¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸Šé¢æ”¾ `mousemove`ã€‚

æ­£å¦‚æˆ‘ä»¬è®°å¾—çš„é‚£æ ·ï¼Œ`mousemove` ä¼šç»å¸¸è¢«è§¦å‘ï¼Œä½†ä¸ä¼šé’ˆå¯¹æ¯ä¸ªåƒç´ éƒ½å¦‚æ­¤ã€‚å› æ­¤åœ¨å¿«é€Ÿç§»åŠ¨ä¹‹åï¼Œå…‰æ ‡å¯ä»¥ä»æ–‡æ¡£ä¸­å¿ƒçš„æŸä¸ªåœ°æ–¹ï¼ˆç”šè‡³æ˜¯çª—å£å¤–ï¼‰ä»çƒä¸Šè·³å‡ºæ¥ã€‚

å› æ­¤ä¸ºäº†æ•è·å®ƒï¼Œæˆ‘ä»¬åº”è¯¥ç›‘å¬ `document`ã€‚

##### [ä¿®æ­£å®šä½](https://zh.javascript.info/mouse-drag-and-drop#xiu-zheng-ding-wei)

åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œçƒæ€»æ˜¯ä»¥æŒ‡é’ˆä¸ºä¸­å¿ƒçš„ï¼š

```javascript
ball.style.left = pageX - ball.offsetWidth / 2 + 'px';
ball.style.top = pageY - ball.offsetHeight / 2 + 'px';
```

ä¸é”™ï¼Œä½†è¿™å­˜åœ¨å‰¯ä½œç”¨ã€‚æˆ‘ä»¬å¯ä»¥åœ¨çƒçš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ `mousedown` æ¥å¼€å§‹æ‹–æ”¾ã€‚å¦‚æœåœ¨è¾¹ç¼˜é‚£ä¹ˆåšï¼Œé‚£ä¹ˆçƒå°±ä¼šçªç„¶â€œè·³â€åˆ°ä»¥æŒ‡é’ˆä¸ºä¸­å¿ƒçš„ä½ç½®ã€‚

å¦‚æœæˆ‘ä»¬ä¿æŒå…ƒç´ ç›¸å¯¹æŒ‡é’ˆçš„åˆå§‹ä½ç§»ï¼Œæƒ…å†µä¼šæ›´å¥½ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä»çƒçš„è¾¹ç¼˜å¤„å¼€å§‹æ‹–åŠ¨ï¼Œé‚£ä¹ˆå…‰æ ‡åœ¨æ‹–åŠ¨æ—¶åº”è¯¥ä¿æŒåœ¨è¾¹ç¼˜ã€‚

![image-20191118150846080](ç¬¬ä¸‰ç« .assets/image-20191118150846080.png)

1. å½“è®¿é—®è€…æŒ‰ä¸‹æŒ‰é’®ï¼ˆ`mousedown`ï¼‰æ—¶ â€”â€” æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å˜é‡ `shiftX/shiftY` æ¥è®°ä½å…‰æ ‡åˆ°çƒå·¦ä¸Šè§’çš„è·ç¦»ã€‚æˆ‘ä»¬åº”è¯¥åœ¨æ‹–åŠ¨æ—¶ä¿æŒè¿™æ ·çš„è·ç¦»ã€‚

   æˆ‘ä»¬å¯ä»¥å‡å»åæ ‡æ¥è·å–ä½ç§»ï¼š

   ```javascript
   // onmousedown
   let shiftX = event.clientX - ball.getBoundingClientRect().left;
   let shiftY = event.clientY - ball.getBoundingClientRect().top;
   ```

   è¯·æ³¨æ„ï¼Œåœ¨ JavaScript ä¸­æ²¡æœ‰è·å–æ–‡æ¡£åæ ‡çš„æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ç›¸å¯¹äºçª—å£çš„åæ ‡ã€‚

2. ç„¶åï¼Œåœ¨æ‹–åŠ¨çƒæ—¶ï¼Œæˆ‘ä»¬å°†çƒæ”¾ç½®åœ¨ç›¸å¯¹äºæŒ‡é’ˆç§»åŠ¨çš„ä½ç½®ä¸Šï¼Œå°±åƒè¿™æ ·ï¼š

   ```javascript
                                         // onmousemove
   // ball has position:absoute
   ball.style.left = event.pageX - shiftX + 'px';
   ball.style.top = event.pageY - shiftY + 'px';
   ```

å…·æœ‰æ›´å¥½å®šä½çš„æœ€ç»ˆä»£ç ï¼š

```javascript
ball.onmousedown = function(event) {

  let shiftX = event.clientX - ball.getBoundingClientRect().left;
  let shiftY = event.clientY - ball.getBoundingClientRect().top;

  ball.style.position = 'absolute';
  ball.style.zIndex = 1000;
  document.body.append(ball);

  moveAt(event.pageX, event.pageY);

  // å°†çƒä¸­å¿ƒå›ºå®šåœ¨ è€ƒè™‘åˆå§‹åç§»çš„(pageX, pageY) åæ ‡ä¸Š
  function moveAt(pageX, pageY) {
    ball.style.left = pageX - shiftX + 'px';
    ball.style.top = pageY - shiftY + 'px';
  }

  function onMouseMove(event) {
    moveAt(event.pageX, event.pageY);
  }

  // (3) ç”¨ mousemove ç§»åŠ¨çƒ
  document.addEventListener('mousemove', onMouseMove);

  // (4) é‡Šæ”¾çƒï¼Œç§»é™¤ä¸éœ€è¦çš„å¤„ç†å™¨
  ball.onmouseup = function() {
    document.removeEventListener('mousemove', onMouseMove);
    ball.onmouseup = null;
  };

};

ball.ondragstart = function() {
  return false;
};
```

å¦‚æœæˆ‘ä»¬æŒ‰åœ¨çƒçš„å³ä¸‹è§’è¿›è¡Œæ‹–åŠ¨ï¼Œè¿™ç§å·®å¼‚å°±ä¼šç‰¹åˆ«æ˜æ˜¾ã€‚åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œçƒåœ¨æŒ‡é’ˆä¸‹â€œè·³åŠ¨â€ã€‚ç°åœ¨ï¼Œå®ƒä»å½“å‰ä½ç½®è·Ÿéšé¼ æ ‡ä¼šå¾ˆæµç•…ã€‚

##### [æ£€æµ‹æ˜¯å¦å¯é‡Šæ”¾](https://zh.javascript.info/mouse-drag-and-drop#jian-ce-shi-fou-ke-shi-fang)

åœ¨ä¹‹å‰çš„ç¤ºä¾‹ä¸­ï¼Œçƒå¯ä»¥åœæ”¾åˆ°â€œä»»ä½•åœ°æ–¹â€ã€‚åœ¨å®é™…ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æŠŠä¸€ä¸ªå…ƒç´ æ”¾åœ¨å¦ä¸€ä¸ªå…ƒç´ ä¸Šã€‚ä¾‹å¦‚ï¼Œå°†æ–‡ä»¶æ”¾å…¥æ–‡ä»¶å¤¹ï¼Œæˆ–è€…ç”¨æˆ·æ”¾å…¥å›æ”¶ç«™ä¹‹ç±»çš„æ“ä½œã€‚

æŠ½è±¡åœ°ï¼Œæˆ‘ä»¬å–ä¸€ä¸ªï¼ˆå¯æ‹–æ”¾çš„ï¼‰â€œdraggableâ€ å…ƒç´ ï¼Œå¹¶å°†å…¶æ”¾åœ¨ï¼ˆå¯é‡Šæ”¾çš„ï¼‰â€œdroppableâ€ å…ƒç´ ä¸Šã€‚

æˆ‘ä»¬éœ€è¦çŸ¥é“æ‹–æ”¾ç»“æŸæ—¶çš„å¯é‡Šæ”¾ç›®æ ‡ â€”â€” æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œï¼Œæœ€å¥½æ˜¯åœ¨æ‹–åŠ¨è¿‡ç¨‹ä¸­é«˜äº®æ˜¾ç¤ºã€‚

è¿™ä¸ªè§£å†³æ–¹æ¡ˆå¾ˆæœ‰æ„æ€ï¼Œåªæ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡ŒæåŠç›¸å…³å†…å®¹ã€‚

ç¬¬ä¸€ä¸ªæƒ³æ³•æ˜¯ä»€ä¹ˆï¼Ÿå¯èƒ½æ˜¯å°† `onmouseover/mouseup` å¤„ç†å™¨æ”¾åœ¨æ½œåœ¨çš„å¯é‡Šæ”¾çš„å…ƒç´ ä¸Šï¼Œç„¶åæ£€æµ‹é¼ æ ‡æŒ‡é’ˆå‡ºç°åœ¨å®ƒä»¬ä¸Šé¢çš„æ—¶æœºã€‚è¿™æ ·æˆ‘ä»¬å°±çŸ¥é“äº†æˆ‘ä»¬æ­£åœ¨è¿™ä¸ªå…ƒç´ ä¸Šè¿›è¡Œæ‹–/æ”¾æ“ä½œ

ä½†è¿™å¹¶ä¸ä¼šè¿è¡Œã€‚

é—®é¢˜æ˜¯å½“æˆ‘ä»¬æ‹–åŠ¨æ—¶ï¼Œå¯æ‹–åŠ¨å…ƒç´ æ€»æ˜¯åœ¨å…¶ä»–å…ƒç´ ä¹‹ä¸Šã€‚è€Œä¸”é¼ æ ‡äº‹ä»¶æ€»æ˜¯å‘ç”Ÿåœ¨é¡¶éƒ¨å…ƒç´ ä¸Šï¼Œè€Œä¸ä¼šåœ¨å…ƒç´ ä¹‹ä¸‹çš„å…¶ä»–å…ƒç´ ä¸Šå‘ç”Ÿã€‚

æ¯”å¦‚ï¼Œä¸‹é¢æœ‰ä¸¤ä¸ª `<div>` å…ƒç´ ï¼Œçº¢è‰²åœ¨è“è‰²é¡¶éƒ¨ã€‚æ²¡æœ‰æ–¹æ³•å¯ä»¥åœ¨è“è‰²çš„äº‹ä»¶ä¸­æ•è·åˆ°ä¸€ä¸ªäº‹ä»¶ï¼Œå› ä¸ºçº¢è‰²åœ¨é¡¶éƒ¨ï¼š

```html
<style>
  div {
    width: 50px;
    height: 50px;
    position: absolute;
    top: 0;
  }
</style>
<div style="background:blue" onmouseover="alert('never works')"></div>
<div style="background:red" onmouseover="alert('over red!')"></div>
```

ä¸ä¸€ä¸ªå¯ä»¥æ‹–åŠ¨çš„å…ƒç´ ç›¸åŒã€‚çƒæ€»æ˜¯åœ¨å…¶ä»–å…ƒç´ ä¹‹ä¸Šï¼Œå› æ­¤äº‹ä»¶ä¼šåœ¨å…¶ä¸Šå‘ç”Ÿã€‚æ— è®ºæˆ‘ä»¬åœ¨ä½å…ƒç´ ä¸Šå¦‚ä½•è®¾ç½®å¤„ç†å™¨ï¼Œå®ƒä»¬éƒ½ä¸ä¼šèµ·ä½œç”¨ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆèµ·åˆå°†å¤„ç†å™¨æ”¾åœ¨æ½œåœ¨çš„å¯é‡Šæ”¾çš„å…ƒç´ ä¸­çš„æƒ³æ³•ï¼Œåœ¨å®é™…æ“ä½œä¸­æ— æ•ˆçš„åŸå› ã€‚å®ƒä»¬æ— æ³•è¿è¡Œã€‚

é‚£ä¹ˆï¼Œè¯¥å¦‚ä½•åšï¼Ÿ

æœ‰ä¸€ä¸ªå«åš `document.elementFromPoint(clientX, clientY)` çš„æ–¹æ³•ã€‚å®ƒä¼šæ ¹æ®ç»™å®šçš„çª—å£ç›¸å¯¹åæ ‡ï¼Œè¿”å›è¯¥å¤„åµŒå¥—æœ€æ·±çš„å…ƒç´ ï¼ˆå…¶å®æ˜¯æœ€é¡¶å±‚çš„å…ƒç´ ï¼Œè¿™é‡Œæ„Ÿè§‰å†™é”™äº†ï¼‰ï¼ˆå¦‚æœåæ ‡åœ¨çª—å£ä¹‹å¤–ï¼Œåˆ™è¿”å› `null`ï¼‰ã€‚

å› æ­¤æˆ‘ä»¬å¯ä»¥æ£€æµ‹ä»»ä½•æƒ…å†µä¸‹çš„é¼ æ ‡äº‹ä»¶ä¸­ï¼ŒæŒ‡é’ˆä¸‹é¢çš„æ½œåœ¨å¯é‡Šæ”¾å…ƒç´ ï¼Œå°±åƒè¿™æ ·ï¼š

```javascript
// åœ¨é¼ æ ‡äº‹ä»¶å¤„ç†å™¨ä¸­
ball.hidden = true; // (*)
let elemBelow = document.elementFromPoint(event.clientX, event.clientY);
ball.hidden = false;
// elemBelow æ˜¯çƒä¸‹é¢çš„å…ƒç´ ã€‚å¦‚æœå®ƒæ˜¯å¯é‡Šæ”¾çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¯¹å®ƒè¿›è¡Œå¤„ç†ã€‚
```

è¯·æ³¨æ„ï¼šæˆ‘ä»¬éœ€è¦åœ¨è°ƒç”¨ `(*)` ä¹‹å‰éšè—çƒã€‚å¦åˆ™ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šåœ¨è¿™äº›åæ ‡ä¸Šæœ‰ä¸ªçƒï¼Œå› ä¸ºå®ƒçš„æ˜¯åœ¨æŒ‡é’ˆä¸‹çš„é¡¶éƒ¨å…ƒç´ ï¼š`elemBelow=ball`ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†å…¶éšè—å¹¶ç«‹å³å†æ¬¡æ˜¾ç¤ºã€‚

åœ¨ä»»ä½•æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨è¯¥ä»£ç æ£€æµ‹æˆ‘ä»¬â€œæ è¿‡â€çš„ä¸œè¥¿ã€‚å½“å®ƒå‘ç”Ÿæ—¶ä¼šè¿›è¡Œé‡Šæ”¾å¤„ç†ã€‚

æ‹“å±•äº† `onMouseMove` æ–¹æ³•ï¼Œç”¨æ¥æŸ¥æ‰¾â€œå¯é‡Šæ”¾çš„â€å…ƒç´ çš„ä»£ç ï¼š

```html
<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <style type="text/css">
  	#gate {
      cursor: pointer;
      margin-bottom: 100px;
      width: 83px;
      height: 46px;
    }

    #ball {
      cursor: pointer;
      width: 40px;
      height: 40px;
    }
  </style>

</head>

<body>

  <p>Drag the ball.</p>

  <img src="https://en.js.cx/clipart/soccer-gate.svg" id="gate" class="droppable">

  <img src="https://en.js.cx/clipart/ball.svg" id="ball">

  <script>
    let currentDroppable = null; // æˆ‘ä»¬æ­£åœ¨é€šè¿‡çš„å¯é‡Šæ”¾å…ƒç´ 

    ball.onmousedown = function(event) {

      let shiftX = event.clientX - ball.getBoundingClientRect().left;
      let shiftY = event.clientY - ball.getBoundingClientRect().top;

      ball.style.position = 'absolute';
      ball.style.zIndex = 1000;
      document.body.append(ball);

      moveAt(event.pageX, event.pageY);

      function moveAt(pageX, pageY) {
        ball.style.left = pageX - shiftX + 'px';
        ball.style.top = pageY - shiftY + 'px';
      }

      function onMouseMove(event) {
        moveAt(event.pageX, event.pageY);

        ball.hidden = true;
        let elemBelow = document.elementFromPoint(event.clientX, event.clientY);
        ball.hidden = false;
				// mousemove äº‹ä»¶å¯èƒ½ä¼šåœ¨çª—å£å¤–è¢«è§¦å‘ï¼ˆå½“çƒè¢«æ‹–å‡ºå±å¹•æ—¶ï¼‰
 				// å¦‚æœ clientX/clientY åœ¨çª—å£å¤–ï¼Œé‚£ä¹ˆ elementfromPoint ä¼šè¿”å› null
        if (!elemBelow) return;
				// æ½œåœ¨çš„å¯é‡Šæ”¾çš„å°†è¢«æ ‡è®°ä¸º "droppable" ç±»ï¼ˆå¯ä»¥æ˜¯å…¶ä»–é€»è¾‘ï¼‰
        let droppableBelow = elemBelow.closest('.droppable');
        if (currentDroppable != droppableBelow) { // å¦‚æœæœ‰ä»»ä½•æ”¹å˜
          if (currentDroppable) { // null when we were not over a droppable before this event
            leaveDroppable(currentDroppable);
          }
          currentDroppable = droppableBelow;
          if (currentDroppable) { // null if we're not coming over a droppable now
            // (maybe just left the droppable)
            enterDroppable(currentDroppable);
          }
        }
      }

      document.addEventListener('mousemove', onMouseMove);

      ball.onmouseup = function() {
        document.removeEventListener('mousemove', onMouseMove);
        ball.onmouseup = null;
      };

    };

    function enterDroppable(elem) {
      elem.style.background = 'pink';
    }

    function leaveDroppable(elem) {
      elem.style.background = '';
    }

    ball.ondragstart = function() {
      return false;
    };
  </script>


</body>
</html>
```

ç°åœ¨åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åœ¨ `currentDroppable` å˜é‡ä¸­å­˜å‚¨äº†å½“å‰ â€œdrop targetâ€ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å®ƒæ¥é«˜äº®æ˜¾ç¤ºæˆ–ä»»ä½•å…¶ä»–å†…å®¹ã€‚

##### [æ€»ç»“](https://zh.javascript.info/mouse-drag-and-drop#zong-jie)

æˆ‘ä»¬è€ƒè™‘äº†ä¸€ç§åŸºç¡€çš„`æ‹–æ”¾`ç®—æ³•ã€‚

å…³é”®éƒ¨åˆ†ï¼š

1. äº‹ä»¶æµï¼š`ball.mousedown` â†’ `document.mousemove` â†’ `ball.mouseup`ï¼ˆå–æ¶ˆåŸç”Ÿ `ondragstart`ï¼‰ã€‚
2. åœ¨æ‹–æ‹½å¯åŠ¨æ—¶ â€”â€” è®°ä½æŒ‡é’ˆç›¸å¯¹äºå…ƒç´ çš„åˆå§‹ä½ç§»ï¼šshiftX/shiftY` å¹¶åœ¨æ‹–åŠ¨è¿‡ç¨‹ä¿æŒçŠ¶æ€ã€‚
3. ä½¿ç”¨ `document.elementFromPoint` æ£€æµ‹æŒ‡é’ˆä¸‹å¯æ”¾ç½®çš„å…ƒç´ ã€‚

æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªåŸºç¡€ä¸Šåšå¾ˆå¤šçš„å·¥ä½œã€‚

- åœ¨ `mouseup` äº‹ä»¶ä¸­æˆ‘ä»¬å¯ä»¥å®Œæˆé‡Šæ”¾ï¼šæ”¹å˜æ•°æ®ï¼Œç§»åŠ¨å…ƒç´ 
- æˆ‘ä»¬å¯ä»¥é«˜äº®æˆ‘ä»¬æ¶‰åŠçš„å…ƒç´ ã€‚
- æˆ‘ä»¬å¯ä»¥æŠŠæ‹–åŠ¨èŒƒå›´é™åˆ¶åœ¨æŸä¸ªåŒºåŸŸå†…
- æˆ‘ä»¬å¯ä»¥å¯¹ `mousedown/up` ä½¿ç”¨äº‹ä»¶å§”æ‰˜ã€‚ä¸€ä¸ªå¤§èŒƒå›´äº‹ä»¶å¤„ç†å™¨å¯ä»¥æ£€æŸ¥ `event.target`ï¼Œå®ƒå¯ä»¥ç®¡ç†æ•°ç™¾ä¸ªå…ƒç´ çš„æ‹–æ”¾ã€‚
- ç­‰ç­‰ã€‚

æœ‰ä¸€äº›å·²ç»æ„å»ºå¥½æ¶æ„çš„æ¡†æ¶ï¼š`DragZone`ã€`Droppable`ã€`Draggable` å’Œå…¶ä»–ç±»ã€‚å®ƒä»¬ä¸­çš„å¤§å¤šæ•°éƒ½åšäº†ç±»ä¼¼çš„äº‹æƒ…ï¼Œæ‰€ä»¥ç°åœ¨åº”è¯¥å¾ˆå®¹æ˜“ç†è§£äº†ã€‚æˆ–è€…æˆ‘ä»¬è‡ªå·±æ»šåŠ¨ï¼Œå› ä¸ºä½ å·²ç»äº†è§£äº†å¦‚ä½•å¤„ç†è¿™ä¸ªè¿‡ç¨‹ï¼Œå®ƒå¯èƒ½æ¯”é€‚åº”å…¶ä»–ä¸œè¥¿æ›´çµæ´»ã€‚

##### ä»»åŠ¡

###### [åœ¨é¢†åŸŸå‘¨å›´æ‹–åŠ¨ superhero](https://zh.javascript.info/mouse-drag-and-drop#zai-ling-yu-zhou-wei-tuo-dong-superhero)

**è‡ªé—­æ¬¡æ•°+1ï¼Œç¬”è€…å®åœ¨å¤ªèœäº†ã€‚**

#### 3.4é”®ç›˜ï¼šæŒ‰ä¸‹é”®ç›˜å’Œé‡Šæ”¾æŒ‰é”®

åœ¨æˆ‘ä»¬å¼€å§‹é”®ç›˜ä¹‹å‰ï¼Œè¯·æ³¨æ„ç°ä»£è®¾å¤‡ä¸Šè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥â€œè¾“å…¥å†…å®¹â€ã€‚æ¯”å¦‚ï¼Œäººä»¬å¯ä»¥ä½¿ç”¨è¯­éŸ³è¯†åˆ«ï¼ˆå°¤å…¶æ˜¯ç§»åŠ¨è®¾å¤‡ï¼‰æˆ–é¼ æ ‡çš„å¤åˆ¶/ç²˜è´´ã€‚

å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·Ÿè¸ª `<input>` åŒºåŸŸä¸­çš„ä»»ä½•è¾“å…¥ï¼Œé”®ç›˜äº‹ä»¶æ˜¯ä¸å¤Ÿçš„ã€‚æ— è®ºå¦‚ä½•ï¼Œè¿˜éœ€è¦ä¸€ä¸ªåä¸º `input`çš„äº‹ä»¶æ¥å¤„ç† `<input>` å­—æ®µçš„å˜æ›´ã€‚å¯¹äºè¿™æ ·çš„ä»»åŠ¡æ¥è¯´ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚æˆ‘ä»¬ä¹‹åå°†åœ¨ [äº‹ä»¶ï¼šchangeã€inputã€cutã€copy å’Œ paste](https://zh.javascript.info/events-change-input) ç« èŠ‚ä¸­è®¨è®ºå®ƒä»¬ã€‚

å½“æˆ‘ä»¬æƒ³è¦å¤„ç†é”®ç›˜åŠ¨ä½œæ—¶ï¼Œåº”ä½¿ç”¨é”®ç›˜äº‹ä»¶ï¼ˆè™šæ‹Ÿé”®ç›˜ä¹Ÿç®—ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¯¹ç®­å¤´é”® Up å’Œ Down æˆ–çƒ­é”®ï¼ˆåŒ…æ‹¬é”®çš„ç»„åˆï¼‰ä½œå‡ºååº”ã€‚

##### [Teststand](https://zh.javascript.info/keyboard-events#keyboard-test-stand)

**é‡Œé¢çš„ä¸œè¥¿è›®å¥½ç©çš„ï¼Œç¬”è®°ä¸å¤ªå¥½æ¬è¿ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå‰å»å¨±ä¹ï¼ŒğŸ˜ã€‚**

##### [Keydown å’Œ keyup](https://zh.javascript.info/keyboard-events#keydown-he-keyup)

å½“é”®è¢«æŒ‰ä¸‹æ—¶ï¼Œ`keydown` äº‹ä»¶ä¼šå‘ç”Ÿï¼Œè€Œå½“é”®è¢«é‡Šæ”¾æ—¶ï¼Œ`keyup` äº‹ä»¶ä¼šå‘ç”Ÿã€‚

###### [event.code å’Œ event.key](https://zh.javascript.info/keyboard-events#eventcode-he-eventkey)

äº‹ä»¶å¯¹è±¡ `key` å±æ€§å…è®¸è·å–å­—ç¬¦ï¼Œè€Œäº‹ä»¶å¯¹è±¡çš„ `code` å±æ€§å…è®¸è·å–â€œç‰©ç†ç§˜é’¥ä»£ç â€ã€‚

ä¾‹å¦‚ï¼Œç›¸åŒçš„é”® Z å¯ä»¥æŒ‰ä¸‹æˆ–è€…ä¸æŒ‰ä¸‹ `Shift`ã€‚è¿™ç»™äº†æˆ‘ä»¬ä¸¤ä¸ªä¸åŒçš„å­—ç¬¦ï¼šå°å†™çš„ `z` å’Œå¤§å†™ `Z`ã€‚

`event.key` æ­£æ˜¯è¿™ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”å®ƒå°†æ˜¯ä¸åŒçš„ã€‚ä½†æ˜¯ï¼Œ`event.code` æ˜¯ç›¸åŒçš„ï¼š

| Key     | `event.key` | `event.code` |
| :------ | :---------- | :----------- |
| Z       | `z`ï¼ˆå°å†™ï¼‰ | `KeyZ`       |
| Shift+Z | `Z`ï¼ˆå¤§å†™ï¼‰ | `KeyZ`       |

å¦‚æœç”¨æˆ·ä½¿ç”¨ä¸åŒçš„è¯­è¨€ï¼Œé‚£ä¹ˆåˆ‡æ¢åˆ°å¦ä¸€ç§è¯­è¨€å°±ä¼šäº§ç”Ÿä¸€ä¸ªå®Œå…¨ä¸åŒçš„å­—ç¬¦ï¼Œè€Œä¸æ˜¯ `"Z"`ã€‚è¿™å°†æˆä¸º `event.key` çš„å€¼ï¼Œè€Œ `event.code` åˆ™å§‹ç»ˆæ˜¯ä¸€æ ·çš„ï¼š`"KeyZ"`ã€‚

------

**â€œKeyZâ€ å’Œå…¶ä»–å¯†é’¥ä»£ç **

æ¯ä¸ªé”®éƒ½æœ‰å–å†³äºå…¶åœ¨é”®ç›˜ä¸Šä½ç½®çš„ä»£ç ã€‚[é”®å€¼ä»£ç åœ¨ UI äº‹ä»¶ä»£ç è§„èŒƒä¸­ä¸­çš„æè¿°](https://www.w3.org/TR/uievents-code/)ã€‚

ä¾‹å¦‚ï¼š

- å­—ç¬¦é”®æœ‰ä»£ç  `"Key<letter>"`ï¼š`"KeyA"` å’Œ `"KeyB"` ç­‰ã€‚
- æ•°å­—é”®æœ‰ä»£ç ï¼š`"Digit<number>"`ï¼š`"Digit0"` å’Œ `"Digit1"` ç­‰ã€‚
- ç‰¹æ®Šç§˜é’¥æŒ‰å…¶åç§°ç¼–ç ï¼š`"Enter"`ã€`"Backspace"` å’Œ `"Tab"` ç­‰ã€‚

æœ‰å‡ ç§é€šç”¨çš„é”®ç›˜å¸ƒå±€ï¼Œè§„èŒƒä¸­ä¸ºå®ƒä»¬æ¯ä¸ªç»™å‡ºäº†é”®å€¼ä»£ç ã€‚

æœ‰å…³æ›´å¤šä»£ç ï¼Œè¯·å‚è§[è¯¥è§„èŒƒçš„å­—æ¯æ•°å­—éƒ¨åˆ†](https://www.w3.org/TR/uievents-code/#key-alphanumeric-section) æˆ–è€…åªæ˜¯å°è¯•ä¸Šé¢çš„ [teststand](https://zh.javascript.info/keyboard-events#keyboard-test-stand)ã€‚

------

**Case matters: `"KeyZ"`, not `"keyZ"`**

æ˜¾è€Œæ˜“è§çš„ï¼Œä½†äººä»¬ä»ä¼šæé”™ã€‚

è¯·é¿å¼€é”™è¯¯ç±»å‹ï¼šå®ƒæ˜¯ `KeyZ` è€Œä¸æ˜¯ `keyZ`ã€‚åƒ `event.code=="keyZ"` è¿™æ ·çš„æ£€æŸ¥ä¸èµ·ä½œç”¨ï¼š`"Key"` çš„ç¬¬ä¸€ä¸ªå­—æ¯å¿…é¡»å¤§å†™ã€‚

------

å¦‚æœé”®æ²¡æœ‰ç»™å‡ºä»»ä½•å­—ç¬¦å‘¢ï¼Ÿä¾‹å¦‚ï¼ŒShift æˆ– F1 æˆ–å…¶ä»–çš„ã€‚å¯¹äºé‚£äº›é”®çš„ `event.key` åˆ™ä¸ `event.code`å¤§è‡´ç›¸åŒï¼š

| Key       | `event.key` | `event.code`                |
| :-------- | :---------- | :-------------------------- |
| F1        | `F1`        | `F1`                        |
| Backspace | `Backspace` | `Backspace`                 |
| Shift     | `Shift`     | `ShiftRight` æˆ– `ShiftLeft` |

è¯·æ³¨æ„ `event.code` ç¡®åˆ‡åœ°æ ‡æ˜äº†å“ªä¸ªé”®è¢«æŒ‰ä¸‹ã€‚ä¾‹å¦‚ï¼Œå¤§å¤šæ•°é”®ç›˜æœ‰ä¸¤ä¸ª Shift é”®ï¼Œä¸€ä¸ªåœ¨å·¦è¾¹ï¼Œä¸€ä¸ªåœ¨å³è¾¹ã€‚`event.code` ç¡®åˆ‡åœ°å‘Šè¯‰æˆ‘ä»¬æŒ‰ä¸‹äº†å“ªä¸ªé”®ï¼Œå¹¶ä¸” `event.key` å¯¹é”®çš„å«ä¹‰è´Ÿè´£ï¼šå®ƒæ˜¯ä»€ä¹ˆï¼ˆä¸€ä¸ª"Shift"ï¼‰ã€‚

æ¯”æ–¹è¯´ï¼Œæˆ‘ä»¬æƒ³è¦å¤„ç†ä¸€ä¸ªçƒ­é”®ï¼šCtrl+Zï¼ˆæˆ– Mac ä¸Šçš„ Cmd+Zï¼‰ã€‚å¤§å¤šæ•°æ–‡æœ¬ç¼–è¾‘å™¨å°†â€œæ’¤é”€â€åŠ¨ä½œæŒ‚åœ¨ä¸Šé¢ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ `keydown` ä¸Šè®¾ç½®ä¸€ä¸ªç›‘å¬è€…ï¼Œæ£€æŸ¥å“ªä¸ªé”®è¢«æŒ‰ä¸‹ â€”â€” ç”¨æ¥æ£€æµ‹æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™éœ€è¦çƒ­é”®ã€‚

è¯·å›ç­”é—®é¢˜ â€”â€” åœ¨è¿™æ ·çš„ç›‘å¬è€…ä¸­ï¼Œæˆ‘ä»¬è¦ç›‘æµ‹çš„æ˜¯ `event.key` è¿˜æ˜¯ `event.code` çš„å€¼ï¼Ÿ

è¯·æš‚åœå¹¶å›ç­”ã€‚

å†³å®šå¥½äº†ä¹ˆï¼Ÿ

å¦‚æœä½ å·²ç»ç†è§£äº†ï¼Œé‚£ä¹ˆç­”æ¡ˆå½“ç„¶æ˜¯ `event.code`ï¼Œå› ä¸ºåœ¨é‚£é‡Œæˆ‘ä»¬ä¸æƒ³è¦ `event.key`ã€‚`event.key` çš„å€¼ä¼šå› ä¸ºè¯­è¨€çš„ä¸åŒæˆ–è€… `CapsLock` çš„ä½¿ç”¨è€Œæ”¹å˜ã€‚`event.code` çš„å€¼è¢«ä¸¥æ ¼ç»‘å®šåˆ°ç§˜é’¥ä¸Šï¼Œå› æ­¤æˆ‘ä»¬ç°åœ¨å¼€å§‹ï¼š

```javascript
document.addEventListener('keydown', function(event) {
  if (event.code == 'KeyZ' && (event.ctrlKey || event.metaKey)) {
    alert('Undo!')
  }
});
```

##### [è‡ªåŠ¨é‡å¤](https://zh.javascript.info/keyboard-events#zi-dong-zhong-fu)

å¦‚æœæŒ‰é”®æ—¶é—´è¶³å¤Ÿé•¿ï¼Œå®ƒå°±ä¼šå¼€å§‹é‡å¤ï¼š`keydown` ä¼šè¢«ä¸€æ¬¡åˆä¸€æ¬¡è§¦å‘ï¼Œå¹¶ä¸”å½“å®ƒé‡Šæ”¾æ—¶æˆ‘ä»¬ç»ˆäºå¾—åˆ° `keyup`ã€‚æ‰€ä»¥æœ‰å¾ˆå¤šçš„ `keydown` å´åªæœ‰ä¸€ä¸ª `keyup` å¾ˆæ­£å¸¸ã€‚

å¯¹äºæ‰€æœ‰çš„é‡å¤é”®ï¼Œäº‹ä»¶å¯¹è±¡çš„ `event.repeat` å±æ€§éƒ½è®¾ç½®ä¸º `true`ã€‚

##### [é»˜è®¤åŠ¨ä½œ](https://zh.javascript.info/keyboard-events#mo-ren-dong-zuo)

é»˜è®¤åŠ¨ä½œå„ä¸ç›¸åŒï¼Œå› ä¸ºé”®ç›˜å¯ä»¥å¼€å§‹è®¸å¤šå¯èƒ½çš„äº‹æƒ…ã€‚

æ¯”å¦‚ï¼š

- ä¸€ä¸ªå­—ç¬¦å‡ºç°åœ¨å±å¹•ä¸Šï¼ˆæœ€æ˜æ˜¾çš„ç»“æœï¼‰ã€‚
- åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼ˆDelete é”®ï¼‰ã€‚
- æ»šåŠ¨é¡µé¢ï¼ˆPageDown é”®ï¼‰ã€‚
- æµè§ˆå™¨æ‰“å¼€â€œä¿å­˜é¡µé¢â€å¯¹è¯æ¡†ï¼ˆCtrl+Sï¼‰
- â€¦ç­‰ç­‰ã€‚

é˜»æ­¢å¯¹ `keydown` çš„é»˜è®¤åŠ¨ä½œå¯ä»¥å–æ¶ˆå…¶ä¸­çš„å¤§å¤šæ•°æ“ä½œï¼Œä½†åŸºäºæ“ä½œç³»ç»Ÿçš„ç‰¹æ®Šé”®é™¤å¤–ã€‚ä¾‹å¦‚åœ¨ Windows é‡Œï¼ŒAlt+F4 å…³é—­å½“å‰æµè§ˆå™¨çª—å£ã€‚ä¹Ÿæ²¡æœ‰åŠæ³•é€šè¿‡é˜»æ­¢ JavaScript ä¸­çš„é»˜è®¤åŠ¨ä½œæ¥é˜»æ­¢å®ƒã€‚

ä¾‹å¦‚ï¼Œä¸‹è¿°çš„ `<input>` æœŸæœ›è¾“å…¥å€¼æ˜¯ç”µè¯å·ç ï¼Œå› æ­¤ä»–ä¸ä¼šæ¥å—é™¤æ•°å­—ã€`+`ã€`()` æˆ– `-`ä»¥å¤–çš„å…¶ä»–é”®ï¼š

```html
<script>
function checkPhoneKey(key) {
  return (key >= '0' && key <= '9') || key == '+' || key == '(' || key == ')' || key == '-';
}
</script>
<input onkeydown="return checkPhoneKey(event.key)" placeholder="Phone, please" type="tel">
```

è¯·æ³¨æ„ï¼Œåƒ Backspaceã€Leftã€Rightã€Ctrl+V è¿™æ ·çš„ç‰¹æ®Šé”®åœ¨è¾“å…¥ä¸­æ— æ•ˆã€‚è¿™æ˜¯ä¸¥æ ¼è¿‡æ»¤å™¨ `checkPhoneKey` çš„å‰¯ä½œç”¨ã€‚

è®©æˆ‘ä»¬æ”¾æ¾ä¸€ä¸‹ï¼š

```html
<script>
function checkPhoneKey(key) {
  return (key >= '0' && key <= '9') || key == '+' || key == '(' || key == ')' || key == '-' ||
    key == 'ArrowLeft' || key == 'ArrowRight' || key == 'Delete' || key == 'Backspace';
}
</script>
<input onkeydown="return checkPhoneKey(event.key)" placeholder="Phone, please" type="tel">
```

ç°åœ¨ç®­å¤´å’Œåˆ é™¤å·¥ä½œæ­£å¸¸ã€‚

â€¦ä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨é¼ æ ‡å³é”® + ç²˜è´´æ¥è¾“å…¥ä»»ä½•å†…å®¹ã€‚å› æ­¤è¿™ä¸ªè¿‡æ»¤å™¨å¹¶ä¸æ˜¯ 100% å¯é ã€‚æˆ‘ä»¬å¯ä»¥è®©å®ƒè¿™æ ·åšï¼Œå› ä¸ºå¤§å¤šæ•°æ—¶å€™å®ƒæ˜¯æœ‰æ•ˆçš„ã€‚æˆ–è€…å¦ä¸€ç§æ–¹æ³•æ˜¯è·Ÿè¸ª `input` äº‹ä»¶ â€”â€” åœ¨ä»»ä½•ä¿®æ”¹åè¢«è§¦å‘ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥ç›‘æµ‹æ–°å€¼å¹¶åœ¨å…¶æ— æ•ˆæ—¶é«˜äº®/ä¿®æ”¹å®ƒã€‚

##### [é—å­˜](https://zh.javascript.info/keyboard-events#yi-cun)

åœ¨è¿‡å»ï¼Œæœ‰ä¸€ä¸ª `keypress` äº‹ä»¶ï¼Œè¿˜æœ‰äº‹ä»¶å¯¹è±¡å±æ€§ `keyCode`ã€`charCode` å’Œ `which`ã€‚

å¤§å¤šæ•°çš„æµè§ˆå™¨éƒ½ä¸å…¼å®¹ï¼Œä»¥è‡³äºå¼€å‘è€…å†³å®šæ”¾å¼ƒè¿™äº›ã€‚ä»¥å‰çš„ä»£ç ä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œå› ä¸ºæµè§ˆå™¨è¿˜æ˜¯æ”¯æŒå®ƒä»¬çš„ï¼Œä½†ç°åœ¨æ²¡æœ‰å¿…è¦å†ä½¿ç”¨è¿™äº›ä»£ç äº†ã€‚

è¿™ç« æœ‰åŒ…æ‹¬äº†å®ƒä»¬è¯¦ç»†æè¿°çš„æ—¶é—´ã€‚ä½†ç°åœ¨æˆ‘ä»¬å¯ä»¥å¿˜è®°å®ƒä»¬äº†ã€‚

##### [æ€»ç»“](https://zh.javascript.info/keyboard-events#zong-jie)

æŒ‰ä¸€ä¸ªé”®æ€»æ˜¯ä¼šäº§ç”Ÿä¸€ä¸ªé”®ç›˜äº‹ä»¶ï¼Œæ— è®ºæ˜¯ç¬¦å·é”®è¿˜æ˜¯ç‰¹æ®Šé”®ï¼Œæ¯”å¦‚ Shift æˆ– Ctrl ç­‰ã€‚å”¯ä¸€çš„ä¾‹å¤–æ˜¯ Fnï¼Œå®ƒæœ‰æ—¶ä¼šå‡ºç°åœ¨ç¬”è®°æœ¬ç”µè„‘é”®ç›˜ä¸Šã€‚å®ƒæ²¡æœ‰é”®ç›˜äº‹ä»¶ï¼Œå› ä¸ºå®ƒé€šå¸¸åœ¨æ¯” OS ä½çš„çº§åˆ«ä¸Šå®ç°çš„ã€‚

é”®ç›˜äº‹ä»¶ï¼š

- `keydown` â€”â€” é•¿ä¹…æŒ‰é”®ï¼ˆå¦‚æœæŒ‰ä¸‹é•¿é”®åˆ™è‡ªåŠ¨é‡å¤ï¼‰ï¼Œ
- `keyup` â€”â€” é‡Šæ”¾æŒ‰é”®æ—¶ã€‚

ä¸»é”®ç›˜äº‹ä»¶å±æ€§ï¼š

- `code` â€”â€” â€œæŒ‰é”®ä»£ç â€ï¼ˆ`"KeyA"`ã€`"ArrowLeft"` ç­‰ï¼‰ï¼Œå…·ä½“åˆ°é”®ç›˜ä¸Šé”®çš„ç‰©ç†ä½ç½®ã€‚
- `key` â€”â€” éå­—ç¬¦é”®çš„å­—ç¬¦ï¼ˆ`"A"`ã€`"a"` ç­‰ï¼‰ï¼Œé€šå¸¸å…·æœ‰å’Œ `code` ä¸€æ ·çš„å€¼ã€‚

è¿‡å»ï¼Œé”®ç›˜äº‹ä»¶æœ‰æ—¶ç”¨äºè·Ÿè¸ªç”¨æˆ·åœ¨è¡¨å•å­—æ®µä¸­çš„è¾“å…¥ã€‚è¿™å¾ˆä¸å¯é ï¼Œå› ä¸ºè¾“å…¥æºå¯ä»¥ä¸åŒã€‚æˆ‘ä»¬æœ‰ `input` å’Œ `change` äº‹ä»¶æ¥å¤„ç†ä»»ä½•è¾“å…¥ï¼ˆä¹‹åæˆ‘ä»¬ä¼šåœ¨ [äº‹ä»¶ï¼šchangeã€inputã€cutã€copy å’Œ paste](https://zh.javascript.info/events-change-input) ç« èŠ‚ä¸­ä½œè¿›ä¸€æ­¥ä»‹ç»ï¼‰ã€‚å®ƒä»¬åœ¨ä»»ä½•è¾“å…¥åè§¦å‘ï¼ŒåŒ…æ‹¬é¼ æ ‡æˆ–è¯­éŸ³è¯†åˆ«ã€‚

å½“æˆ‘ä»¬çœŸæ­£æƒ³è¦é”®ç›˜æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨é”®ç›˜äº‹ä»¶ã€‚æ¯”å¦‚ï¼Œå¯¹çƒ­é”®æˆ–ç‰¹æ®Šé”®ä½œå‡ºååº”ã€‚

#### 3.5æ»šåŠ¨

æ»šåŠ¨äº‹ä»¶å…è®¸åœ¨é¡µé¢æˆ–å…ƒç´ ä¸Šæ»šåŠ¨æ—¶ä½œå‡ºååº”ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…ã€‚

æ¯”å¦‚ï¼š

- æ ¹æ®ç”¨æˆ·åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®æ˜¾ç¤º/éšè—å…¶ä»–æ§ä»¶æˆ–ä¿¡æ¯ã€‚
- å½“ç”¨æˆ·æ»šåŠ¨åˆ°é¡µé¢æœ«å°¾æ—¶åŠ è½½æ›´å¤šçš„æ•°æ®ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªæ˜¾ç¤ºå½“å‰æ»šåŠ¨çš„å°å‡½æ•°ï¼š

```javascript
window.addEventListener('scroll', function() {
  document.getElementById('showScroll').innerHTML = pageYOffset + 'px';
});
```

`scroll` äº‹ä»¶åœ¨ `window` å’Œå¯æ»šåŠ¨å…ƒç´ ä¸Šéƒ½å¯ä»¥è¿è¡Œã€‚

##### [é˜²æ­¢æ»šåŠ¨](https://zh.javascript.info/onscroll#fang-zhi-gun-dong)

æˆ‘ä»¬æ€æ ·è®©æŸäº›ä¸œè¥¿ä¸å¯æ»šåŠ¨å‘¢ï¼Ÿæˆ‘ä»¬ä¸èƒ½åœ¨ `onscroll` ç›‘å¬è€…ä¸­é€šè¿‡ä½¿ç”¨ `event.preventDefault()` æ¥é˜»æ­¢æ»šåŠ¨ï¼Œå› ä¸ºå®ƒåœ¨æ»šåŠ¨å‘ç”Ÿ**ä¹‹å**æ‰è§¦å‘ã€‚

ä½†æˆ‘ä»¬å¯ä»¥åœ¨å¯¼è‡´æ»šåŠ¨çš„äº‹ä»¶ä¸Šä½¿ç”¨ `event.preventDefault()` æ¥é˜»æ­¢æ»šåŠ¨ã€‚

ä¾‹å¦‚ï¼š

- `wheel` äº‹ä»¶ â€”â€” é¼ æ ‡æ»šè½®ï¼ˆâ€œæ»šåŠ¨â€è§¦æ§æ¿ä¹Ÿä¼šç”Ÿæˆå®ƒï¼‰ã€‚
- pageUp å’Œ pageDown çš„ `keydown` äº‹ä»¶ã€‚

æœ‰æ—¶å¯èƒ½ä¼šæœ‰å¸®åŠ©ï¼Œä½†è¿˜æœ‰å¾ˆå¤šæ»šåŠ¨æ–¹å¼ï¼Œæ‰€ä»¥å¾ˆéš¾å¤„ç†å®ƒä»¬ã€‚å› æ­¤ï¼Œä½¿ç”¨ CSS è®©ä¸€äº›ä¸œè¥¿ä¸å¯æ»šåŠ¨æ›´ä¸ºå¯é ï¼Œæ¯”å¦‚ `overflow` å±æ€§ã€‚

è¿™é‡Œæœ‰å‡ ä¸ªä½ å¯ä»¥å®Œæˆçš„ç»ƒä¹ ï¼Œä½ ä¹Ÿå¯ä»¥çœ‹å®ƒä»¬å…³äº `onscroll` çš„åº”ç”¨ã€‚

##### ä»»åŠ¡

###### [åŠ è½½å¯è§†åŒ–å›¾åƒ](https://zh.javascript.info/onscroll#jia-zai-ke-shi-hua-tu-xiang)

**è¿™ä¸ªä¸ç®—éš¾é¢˜ï¼Œä½†æ˜¯å¾ˆæœ‰ä»·å€¼ã€‚**



